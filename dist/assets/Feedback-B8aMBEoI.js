import{w as F,r as i,j as e,B as C}from"./index-BS3gJMZe.js";function R(a){return F("/contact",a)}function E(a){return!!a&&/\S+@\S+\.\S+/.test(a)}const l=500;function M(){const[a,o]=i.useState({name:"",email:"",category:"",message:"",consent:!1,website:""}),[r,g]=i.useState({}),[n,x]=i.useState(!1),[y,h]=i.useState(!1),[v,c]=i.useState(""),d=i.useRef(null),m=i.useRef(null),u=i.useRef(null),f=i.useRef(null),b=i.useRef(null),j=s=>{const t={};return s.category||(t.category="Please choose a category."),s.message.trim()||(t.message="Please describe your feedback."),s.message.length>l&&(t.message=`Please keep your message within ${l} characters.`),s.email&&!E(s.email)&&(t.email="Please provide a valid email."),s.consent||(t.consent="Please confirm you agree to our privacy notice."),s.website.trim()&&(t.website="Spam detected."),t},k=s=>{if(s.category&&u.current)return u.current.focus();if(s.message&&f.current)return f.current.focus();if(s.email&&m.current)return m.current.focus();if(s.consent&&b.current)return b.current.focus();d.current&&d.current.focus()},w=async s=>{s.preventDefault(),h(!1),c("");const t=j(a);if(g(t),Object.keys(t).length>0){k(t);return}x(!0),c("Sending feedback…");try{const S={name:a.name||void 0,email:a.email||void 0,category:a.category,message:a.message.slice(0,l),agree:a.consent,meta:{source:"web",page:window.location?.pathname??"/feedback"}},p=await R(S);p.status==="ok"?(h(!0),c("Thanks! Your feedback has been received."),o({name:"",email:"",category:"",message:"",consent:!1,website:""})):c(p.message||"Something went wrong. Please try again.")}catch{c("Network error. Please try again.")}finally{x(!1)}},N=s=>{o(t=>({...t,message:s.slice(0,l)})),r.message&&s.length<=l&&g(t=>({...t,message:void 0}))};return e.jsxs("main",{className:"mx-auto max-w-3xl px-4 py-12",children:[e.jsxs("header",{children:[e.jsx("h1",{className:"text-3xl lg:text-4xl font-extrabold text-ink",children:"Send Feedback"}),e.jsx("p",{className:"mt-3 text-ink-soft",children:"We value your input. Tell us what works well and what could be improved."})]}),e.jsx("p",{"aria-live":"polite",className:"sr-only",children:v}),e.jsxs("form",{className:"mt-8 space-y-6",onSubmit:w,noValidate:!0,children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"fb-name",className:"block text-sm font-medium text-ink",children:"Name (optional)"}),e.jsx("input",{id:"fb-name",ref:d,type:"text",autoComplete:"name",value:a.name,onChange:s=>o(t=>({...t,name:s.target.value})),className:"mt-2 h-11 w-full rounded-full border border-border px-4 outline-none focus-visible:ring-2 focus-visible:ring-primary/40",placeholder:"Your name",disabled:n})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"fb-email",className:"block text-sm font-medium text-ink",children:"Email (optional)"}),e.jsx("input",{id:"fb-email",ref:m,type:"email",inputMode:"email",autoComplete:"email",value:a.email,onChange:s=>o(t=>({...t,email:s.target.value})),"aria-invalid":!!r.email||void 0,"aria-describedby":r.email?"fb-email-err":void 0,className:"mt-2 h-11 w-full rounded-full border border-border px-4 outline-none focus-visible:ring-2 focus-visible:ring-primary/40",placeholder:"you@example.com",disabled:n}),r.email&&e.jsx("p",{id:"fb-email-err",className:"mt-2 text-sm text-red-600",children:r.email})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"fb-category",className:"block text-sm font-medium text-ink",children:"Category *"}),e.jsxs("select",{id:"fb-category",ref:u,value:a.category,onChange:s=>o(t=>({...t,category:s.target.value})),"aria-invalid":!!r.category||void 0,"aria-describedby":r.category?"fb-category-err":void 0,className:"mt-2 h-11 w-full rounded-full border border-border px-4 outline-none bg-white focus-visible:ring-2 focus-visible:ring-primary/40",disabled:n,children:[e.jsx("option",{value:"",children:"Select a category…"}),e.jsx("option",{value:"Bug",children:"Bug"}),e.jsx("option",{value:"Feature request",children:"Feature request"}),e.jsx("option",{value:"Idea",children:"Idea"}),e.jsx("option",{value:"Other",children:"Other"})]}),r.category&&e.jsx("p",{id:"fb-category-err",className:"mt-2 text-sm text-red-600",children:r.category})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("label",{htmlFor:"fb-message",className:"block text-sm font-medium text-ink",children:"Message *"}),e.jsxs("span",{className:"text-xs text-ink-soft",children:[a.message.length,"/",l]})]}),e.jsx("textarea",{id:"fb-message",ref:f,value:a.message,onChange:s=>N(s.target.value),maxLength:l,"aria-invalid":!!r.message||void 0,"aria-describedby":r.message?"fb-message-err":"fb-message-hint",className:"mt-2 min-h-[140px] w-full rounded-2xl border border-border p-4 outline-none focus-visible:ring-2 focus-visible:ring-primary/40",placeholder:"Describe the issue or your idea…",disabled:n}),e.jsxs("p",{id:"fb-message-hint",className:"mt-1 text-xs text-ink-soft",children:["Up to ",l," characters."]}),r.message&&e.jsx("p",{id:"fb-message-err",className:"mt-2 text-sm text-red-600",children:r.message})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("input",{id:"fb-consent",ref:b,type:"checkbox",checked:a.consent,onChange:s=>o(t=>({...t,consent:s.target.checked})),"aria-invalid":!!r.consent||void 0,"aria-describedby":r.consent?"fb-consent-err":void 0,className:"mt-1 h-5 w-5 rounded border-border text-primary focus-visible:ring-2 focus-visible:ring-primary/40",disabled:n}),e.jsx("label",{htmlFor:"fb-consent",className:"text-sm text-ink",children:"I agree that my feedback may be stored and processed to improve the product."})]}),r.consent&&e.jsx("p",{id:"fb-consent-err",className:"text-sm text-red-600",children:r.consent}),e.jsxs("div",{"aria-hidden":"true",className:"hidden",children:[e.jsx("label",{htmlFor:"fb-website",children:"Website"}),e.jsx("input",{id:"fb-website",type:"text",value:a.website,onChange:s=>o(t=>({...t,website:s.target.value})),tabIndex:-1,autoComplete:"off"})]}),e.jsxs("div",{className:"pt-2",children:[e.jsx(C,{size:"lg",variant:"primary",loading:n,disabled:n,type:"submit",children:n?"Sending…":"Submit feedback"}),y&&!n&&e.jsx("p",{className:"mt-3 text-sm text-green-700",children:"Your feedback was submitted successfully."})]})]})]})}export{M as default};
